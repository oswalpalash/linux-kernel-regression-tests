// https://syzkaller.appspot.com/bug?id=6b4e2b81615c710577f2832bf4d54a7834fa11de
// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#ifndef __NR_bpf
#define __NR_bpf 321
#endif

uint64_t r[1] = {0xffffffffffffffff};

int main(void)
{
  syscall(__NR_mmap, /*addr=*/0x1ffffffff000ul, /*len=*/0x1000ul, /*prot=*/0ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  syscall(__NR_mmap, /*addr=*/0x200000000000ul, /*len=*/0x1000000ul,
          /*prot=PROT_WRITE|PROT_READ|PROT_EXEC*/ 7ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  syscall(__NR_mmap, /*addr=*/0x200001000000ul, /*len=*/0x1000ul, /*prot=*/0ul,
          /*flags=MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE*/ 0x32ul,
          /*fd=*/(intptr_t)-1, /*offset=*/0ul);
  const char* reason;
  (void)reason;
  intptr_t res = 0;
  if (write(1, "executing program\n", sizeof("executing program\n") - 1)) {
  }
  syscall(__NR_bpf, /*cmd=*/5ul, /*arg=*/0ul, /*size=*/0ul);
  memcpy((void*)0x2000000000c0,
         "\x01\x00\x00\x00\x12\x00\x00\x00\x7f\x00\x00\x00\x01", 13);
  res =
      syscall(__NR_bpf, /*cmd=*/0ul, /*arg=*/0x2000000000c0ul, /*size=*/0x48ul);
  if (res != -1)
    r[0] = res;
  syscall(__NR_bpf, /*cmd=*/0xful, /*arg=*/0ul, /*size=*/0ul);
  *(uint32_t*)0x2000000008c0 = 6;
  *(uint32_t*)0x2000000008c4 = 8;
  *(uint64_t*)0x2000000008c8 = 0x2000000002c0;
  memcpy((void*)0x2000000002c0,
         "\x18\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18"
         "\x12\x00\x00",
         20);
  *(uint32_t*)0x2000000002d4 = r[0];
  memcpy((void*)0x2000000002d8,
         "\x00\x00\x00\x00\x00\x00\x00\x00\xb7\x03\x00\x00\x00\x00\x00\x00\x85"
         "\x00\x00\x00\x0c\x00\x00\x00\xb7\x00\x00\x00\x00\x00\x00\x00\x95\x00"
         "\x00\x00\x00\x00\x00\x00\xfa\x54\x14\x0e\xbe\x26\x2d\x08\xee\xee\xbc"
         "\xc7\x10\x2f\x86\x12\xb6\x39\x2d\xe9\x3b\xaa\x0c\xfa\xbb\x12\x35\xce"
         "\xa6\x10\x69\xd4\xa7\x96\xa3\xed\x9f\x56\x1d\x2d\xfe\xd6\xb7",
         83);
  *(uint64_t*)0x2000000008d0 = 0x200000000040;
  memcpy((void*)0x200000000040, "GPL\000", 4);
  *(uint32_t*)0x2000000008d8 = 5;
  *(uint32_t*)0x2000000008dc = 0;
  *(uint64_t*)0x2000000008e0 = 0;
  *(uint32_t*)0x2000000008e8 = 0x1f00;
  *(uint32_t*)0x2000000008ec = 0;
  memset((void*)0x2000000008f0, 0, 16);
  *(uint32_t*)0x200000000900 = 0;
  *(uint32_t*)0x200000000904 = 0x25;
  *(uint32_t*)0x200000000908 = -1;
  *(uint32_t*)0x20000000090c = 8;
  *(uint64_t*)0x200000000910 = 0;
  *(uint32_t*)0x200000000918 = 0;
  *(uint32_t*)0x20000000091c = 0x10;
  *(uint64_t*)0x200000000920 = 0;
  *(uint32_t*)0x200000000928 = 0;
  *(uint32_t*)0x20000000092c = 0;
  *(uint32_t*)0x200000000930 = 0;
  *(uint32_t*)0x200000000934 = 0;
  *(uint64_t*)0x200000000938 = 0;
  *(uint64_t*)0x200000000940 = 0;
  *(uint32_t*)0x200000000948 = 0x10;
  *(uint32_t*)0x20000000094c = 7;
  *(uint32_t*)0x200000000950 = 0;
  syscall(__NR_bpf, /*cmd=*/5ul, /*arg=*/0x2000000008c0ul, /*size=*/0x94ul);
  return 0;
}
