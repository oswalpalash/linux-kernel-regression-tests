// https://syzkaller.appspot.com/bug?id=2bf7b7983c2398ec6f0c4c6c87cb50223e8873f8
// autogenerated by syzkaller (http://github.com/google/syzkaller)

#define _GNU_SOURCE
#include <endian.h>
#include <stdint.h>
#include <string.h>
#include <sys/syscall.h>
#include <unistd.h>

#ifndef __NR_mmap
#define __NR_mmap 192
#endif
#ifndef __NR_openat
#define __NR_openat 295
#endif
#ifndef __NR_ioctl
#define __NR_ioctl 54
#endif
#undef __NR_mmap
#define __NR_mmap __NR_mmap2

long r[3];
void loop()
{
  memset(r, -1, sizeof(r));
  syscall(__NR_mmap, 0x20000000, 0xfff000, 3, 0x32, -1, 0);
  memcpy((void*)0x20363ff7, "/dev/kvm", 9);
  r[0] = syscall(__NR_openat, 0xffffff9c, 0x20363ff7, 0, 0);
  r[1] = syscall(__NR_ioctl, r[0], 0xae01, 0);
  r[2] = syscall(__NR_ioctl, r[1], 0xae41, 0);
  *(uint64_t*)0x20271000 = 0;
  *(uint32_t*)0x20271008 = 0;
  *(uint16_t*)0x2027100c = 0;
  *(uint8_t*)0x2027100e = 0;
  *(uint8_t*)0x2027100f = 0;
  *(uint8_t*)0x20271010 = 0;
  *(uint8_t*)0x20271011 = 0;
  *(uint8_t*)0x20271012 = 0;
  *(uint8_t*)0x20271013 = 0;
  *(uint8_t*)0x20271014 = 0;
  *(uint8_t*)0x20271015 = 0;
  *(uint8_t*)0x20271016 = 0;
  *(uint8_t*)0x20271017 = 0;
  *(uint64_t*)0x20271018 = 0;
  *(uint32_t*)0x20271020 = 0;
  *(uint16_t*)0x20271024 = 0;
  *(uint8_t*)0x20271026 = 0;
  *(uint8_t*)0x20271027 = 0;
  *(uint8_t*)0x20271028 = 0;
  *(uint8_t*)0x20271029 = 0;
  *(uint8_t*)0x2027102a = 0;
  *(uint8_t*)0x2027102b = 0;
  *(uint8_t*)0x2027102c = 0;
  *(uint8_t*)0x2027102d = 0;
  *(uint8_t*)0x2027102e = 0;
  *(uint8_t*)0x2027102f = 0;
  *(uint64_t*)0x20271030 = 0;
  *(uint32_t*)0x20271038 = 0;
  *(uint16_t*)0x2027103c = 0;
  *(uint8_t*)0x2027103e = 0;
  *(uint8_t*)0x2027103f = 0;
  *(uint8_t*)0x20271040 = 0;
  *(uint8_t*)0x20271041 = 0;
  *(uint8_t*)0x20271042 = 0;
  *(uint8_t*)0x20271043 = 0;
  *(uint8_t*)0x20271044 = 0;
  *(uint8_t*)0x20271045 = 0;
  *(uint8_t*)0x20271046 = 0;
  *(uint8_t*)0x20271047 = 0;
  *(uint64_t*)0x20271048 = 0;
  *(uint32_t*)0x20271050 = 0;
  *(uint16_t*)0x20271054 = 0;
  *(uint8_t*)0x20271056 = 0;
  *(uint8_t*)0x20271057 = 0;
  *(uint8_t*)0x20271058 = 0;
  *(uint8_t*)0x20271059 = 0;
  *(uint8_t*)0x2027105a = 0;
  *(uint8_t*)0x2027105b = 0;
  *(uint8_t*)0x2027105c = 0;
  *(uint8_t*)0x2027105d = 0;
  *(uint8_t*)0x2027105e = 0;
  *(uint8_t*)0x2027105f = 0;
  *(uint64_t*)0x20271060 = 0;
  *(uint32_t*)0x20271068 = 0;
  *(uint16_t*)0x2027106c = 0;
  *(uint8_t*)0x2027106e = 0;
  *(uint8_t*)0x2027106f = 0;
  *(uint8_t*)0x20271070 = 0;
  *(uint8_t*)0x20271071 = 0;
  *(uint8_t*)0x20271072 = 0;
  *(uint8_t*)0x20271073 = 0;
  *(uint8_t*)0x20271074 = 0;
  *(uint8_t*)0x20271075 = 0;
  *(uint8_t*)0x20271076 = 0;
  *(uint8_t*)0x20271077 = 0;
  *(uint64_t*)0x20271078 = 0;
  *(uint32_t*)0x20271080 = 0;
  *(uint16_t*)0x20271084 = 0;
  *(uint8_t*)0x20271086 = 0;
  *(uint8_t*)0x20271087 = 0;
  *(uint8_t*)0x20271088 = 0;
  *(uint8_t*)0x20271089 = 0;
  *(uint8_t*)0x2027108a = 0;
  *(uint8_t*)0x2027108b = 0;
  *(uint8_t*)0x2027108c = 0;
  *(uint8_t*)0x2027108d = 0;
  *(uint8_t*)0x2027108e = 0;
  *(uint8_t*)0x2027108f = 0;
  *(uint64_t*)0x20271090 = 0;
  *(uint32_t*)0x20271098 = 0;
  *(uint16_t*)0x2027109c = 0;
  *(uint8_t*)0x2027109e = 0;
  *(uint8_t*)0x2027109f = 0;
  *(uint8_t*)0x202710a0 = 0;
  *(uint8_t*)0x202710a1 = 0;
  *(uint8_t*)0x202710a2 = 0;
  *(uint8_t*)0x202710a3 = 0;
  *(uint8_t*)0x202710a4 = 0;
  *(uint8_t*)0x202710a5 = 0;
  *(uint8_t*)0x202710a6 = 0;
  *(uint8_t*)0x202710a7 = 0;
  *(uint64_t*)0x202710a8 = 0;
  *(uint32_t*)0x202710b0 = 0;
  *(uint16_t*)0x202710b4 = 0;
  *(uint8_t*)0x202710b6 = 0;
  *(uint8_t*)0x202710b7 = 0;
  *(uint8_t*)0x202710b8 = 0;
  *(uint8_t*)0x202710b9 = 0;
  *(uint8_t*)0x202710ba = 0;
  *(uint8_t*)0x202710bb = 0;
  *(uint8_t*)0x202710bc = 0;
  *(uint8_t*)0x202710bd = 0;
  *(uint8_t*)0x202710be = 0;
  *(uint8_t*)0x202710bf = 0;
  *(uint64_t*)0x202710c0 = 0;
  *(uint16_t*)0x202710c8 = 0;
  *(uint16_t*)0x202710ca = 0;
  *(uint16_t*)0x202710cc = 0;
  *(uint16_t*)0x202710ce = 0;
  *(uint64_t*)0x202710d0 = 0;
  *(uint16_t*)0x202710d8 = 0;
  *(uint16_t*)0x202710da = 0;
  *(uint16_t*)0x202710dc = 0;
  *(uint16_t*)0x202710de = 0;
  *(uint64_t*)0x202710e0 = 0x80000019;
  *(uint64_t*)0x202710e8 = 0;
  *(uint64_t*)0x202710f0 = 0;
  *(uint64_t*)0x202710f8 = 0x1a0;
  *(uint64_t*)0x20271100 = 0;
  *(uint64_t*)0x20271108 = 0xfffffffffffffffc;
  *(uint64_t*)0x20271110 = 0;
  *(uint64_t*)0x20271118 = 0;
  *(uint64_t*)0x20271120 = 0;
  *(uint64_t*)0x20271128 = 0;
  *(uint64_t*)0x20271130 = 0;
  syscall(__NR_ioctl, r[2], 0x4138ae84, 0x20271000);
  syscall(__NR_ioctl, r[2], 0xae80, 0);
}

int main()
{
  loop();
  return 0;
}
