// https://syzkaller.appspot.com/bug?id=f8cbc35871dfec2a0923225cb403c7b1e159538b
// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#ifndef __NR_memfd_create
#define __NR_memfd_create 319
#endif

uint64_t r[1] = {0xffffffffffffffff};

int main(void)
{
  syscall(__NR_mmap, /*addr=*/0x1ffff000ul, /*len=*/0x1000ul, /*prot=*/0ul,
          /*flags=*/0x32ul, /*fd=*/-1, /*offset=*/0ul);
  syscall(__NR_mmap, /*addr=*/0x20000000ul, /*len=*/0x1000000ul, /*prot=*/7ul,
          /*flags=*/0x32ul, /*fd=*/-1, /*offset=*/0ul);
  syscall(__NR_mmap, /*addr=*/0x21000000ul, /*len=*/0x1000ul, /*prot=*/0ul,
          /*flags=*/0x32ul, /*fd=*/-1, /*offset=*/0ul);
  intptr_t res = 0;
  memcpy(
      (void*)0x200001c0,
      "\377\000l\036\240</"
      "\000\216._\024zC\232\350\340u\340\377\361\262\375\366nz\005-"
      "\342\307\323\346M^\230\205x\024\t\351Q1\035K\232\0045\323\027\2622\375D("
      "\322\335\240\377\037\000\000\n\000\000\000v\n\330?]"
      "k\024N\030\364\302j\3436g\375\322\324\343\037\246\306\342\246!\232E<2`]<"
      "\362R?8\270\243\277\303\030s\367!~"
      "0\307y\342\262VP\275\260\226\220\221k\206\032\020\322\365\213\374\364"
      "\320[\022\365+\032S\002/Yxm\226\277S\227\234/"
      "\0375i\306\2061\314#\2204\360K\224\2555("
      "\371\330mMK\212\377\303\347\277U\325\254\314B=\217\37526<Z|"
      "U6\r\327\030\255\035`\006\317N\a\371\327 "
      "\032\330\357\266\2368Z\t:#r\242\261h\300\300a\251\3046A\001\254\346\277 "
      "!5I\311<\031{)\244\255\v\2223\b\235\275>,\301\215\\Rxt\'\266\277\310*"
      "\n\257\033\354\375\273Y\231\263\006c\326\366\260\315=\363\003`"
      "\223\377\005e\252$\000\352w\331\020\017\035\2108\214S\022?"
      "R\231\3327\316)"
      "\217\314\207\000\000\000\000\000\000\000\000\000\000\000\000\000\000\323"
      "2J\327\237\352:=\314\027(|"
      "L\332\303\034a\350s\266\353w\307\253S\327pJ\322\241\317\256\0372\237\230"
      "\2500\r\205\264\206\274\320\352\277\261Z\267e$\317<"
      "\ra\233\245\334\v\036\375\307\221\3622\317\226\231\301\273\241j\345\250"
      "\177\a\251\247G\255\243\213\361\333\\]"
      "R\214f\2541\327V\257\265\216\020\225\237=2\320-\341K:"
      "\303b\211\025OS\245\230Ky\022\347Qt#"
      "\353\231\a\020\034\263N\205\353\200\005\202_"
      "\025\334\274\3713\335\365g\230\324\212z\344`"
      "\245\000\000\000\000\315\023\374+"
      "\254\345\213I\f\326\211\307HY\317\000O\210\346\213\213F/"
      "\202u\377Cng@y\246=4\261}\250Yr\2559\271b)\354}\207=\221:"
      "IV\253\337\242\272+6D\037uf\336JYw$"
      "L\241\203NH\343\362\221\214W\267\b\004\022\213\213V\031\361\r\313\224"
      "\243\364\344\227$\231c\rG\327#\342\375\200\255R\203\334\270d\025|"
      "\254\270g$\017@\3123\237\261\352\306vQ\033\333#"
      "\243\"\237\236\330\272\023d\233x\232\277\356\362kQ\340\304/"
      "~7\315\321\006\345\027\233\bW|\274\206D\005\257<\337y,I2f\247G\343Qp<"
      "\'6 "
      "x\n\224f\370\242\352\364\245\236Y\3700C\221\177\026u\214("
      "Xl\220\322\237\251\244\204Jy[\223\376{\345\032\351\267T\031;"
      "\271\t\347\016i\372Z\373S:\233\301r\313M.\370\270wR\263p~b\313\v1-\a-"
      "\212#\2521\251\232\210\a\305\271*\323?"
      "\254\n\234\315\342\311\275\353\263\3665\275aP\t\326\006\034\356Ng\222>"
      "\222>\257\b3\005\375M\322F\v\275\353\203 "
      "\235\220S\021w\357g\\\312\342\374~w\276\357h#"
      "\301\352h\354\277r\310Bi\220\"(\362\306\314\373X\024{"
      "\2365\207\221\342\233\324\306\302whk+\017\202\312\301@\313~"
      "P\344\030\371E\'\253\307z\327\005V{\241X\243\020\023.]"
      "tlz\022\336\362\2443\356#\222J~\332 "
      "\233\304\300V\263\235CO\037u\0344\035\v}\033\345>w\373sm\243\fI|\226-"
      "p\206\323O\372\232\217\262\216\210qGEG",
      906);
  res = syscall(__NR_memfd_create, /*name=*/0x200001c0ul, /*flags=*/4ul);
  if (res != -1)
    r[0] = res;
  syscall(__NR_mmap, /*addr=*/0x20000000ul, /*len=*/0x800000ul,
          /*prot=*/0x2000002ul, /*flags=*/0x4d091ul, /*fd=*/r[0],
          /*offset=*/0ul);
  *(uint64_t*)0x20000180 = 0x20000000;
  *(uint64_t*)0x20000188 = 0x200000;
  *(uint64_t*)0x20000190 = 0;
  *(uint64_t*)0x20000198 = 2;
  syscall(__NR_preadv, /*fd=*/r[0], /*vec=*/0x20000180ul, /*vlen=*/2ul,
          /*off_low=*/0, /*off_high=*/0);
  return 0;
}
