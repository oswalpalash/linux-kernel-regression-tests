// https://syzkaller.appspot.com/bug?id=0c8e5c99b3db338c8956fcb7231eb1f7e2d707f9
// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

uint64_t r[2] = {0xffffffffffffffff, 0xffffffffffffffff};

int main(void)
{
  syscall(__NR_mmap, 0x20000000, 0x1000000, 3, 0x32, -1, 0);
  intptr_t res = 0;
  memcpy((void*)0x20000100, "/dev/net/tun\000", 13);
  res = syscall(__NR_openat, 0xffffffffffffff9c, 0x20000100, 2, 0);
  if (res != -1)
    r[0] = res;
  memcpy((void*)0x20000300,
         "nr0\001\000\000\000\000\000\000\000\000\000\000\000\000", 16);
  *(uint16_t*)0x20000310 = 0x4005;
  syscall(__NR_ioctl, r[0], 0x400454ca, 0x20000300);
  res = syscall(__NR_socket, 0x29, 5, 0);
  if (res != -1)
    r[1] = res;
  memcpy((void*)0x20000500,
         "nr0\001\000`\241\236\371\322\306s\331\241W\034\271\3416\233\315a\357~"
         "Iy:\341\207\022\354\353\035\252v\224\227\200\v\177\273\323["
         "\027\f\020u\0359\256\266`\330c\344\233\214O;=\255H\220+[-"
         "l\375\n\2757,c\274\365\327\r\363\375M.\215D<"
         "\210\274\016V7\335\202\37445\276\324\336]i<\232x\034\206>"
         "\005\330\246\370h\232[\342\222\026\006\037?\365?\213k9fx\347\272\025^"
         "\371\025-~C\261\354\313#"
         "1\353\216\261\355U\206\334\370\263\260\271\2316\032D\377,"
         "\"\302\253\276\364-"
         "\322N\253\346r3F\246\344l\004\231\242\024B\330\320\r\313W\360\023\377"
         "u\225\355\320\377\ai0\3366u\323A\027\244N\260\344\3702\223m\244NW\344"
         ":>6\275H\322\250["
         "\364\375J\200N\203\362\363\3177\212CZ\365\342\207\324\342s7\264\255"
         "\241\033&!\2302\354k+8Dk;\225\3767q\351\364,"
         "\243\017\262\036\022\360\243\330\274-\205EJ\371\374\300#-"
         "\217\331\tD\213\001\364lY=1\352\034\222de\343ZA\231\a\234<\244\021("
         "\261|\260\037\277[R+\340\375\002\002*"
         "\3327\376\314\024\266\310\310\203\030\203\270Z\021\006\362\370g\002\r"
         "R\237\027\243P\362\r\323\277Q\251\214\375\247\f.68\244\203\375?"
         "\207\224\v\264x\260|L\021\003\224\300\t="
         "\027\225P\211\362\312\227\273\340u\022L\233\205\226\340\b\277\n\002"
         "\213S\234\354yl\354\233\365\205\353\200\376>\r&",
         410);
  syscall(__NR_ioctl, r[1], 0x8914, 0x20000500);
  memcpy((void*)0x200000c0, "\x00\x38\x88\xa8\xff", 5);
  syscall(__NR_write, r[0], 0x200000c0, 0xfdef);
  return 0;
}
