// https://syzkaller.appspot.com/bug?id=8e03060c883cb5a2f82bfd531d70e36555ba61a5
// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

uint64_t r[1] = {0xffffffffffffffff};

int main(void)
{
  syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
  syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
  syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
  intptr_t res = 0;
  memcpy((void*)0x20000040, "./file1\000", 8);
  syscall(__NR_mkdir, 0x20000040ul, 0ul);
  memcpy((void*)0x20000180, "./bus\000", 6);
  syscall(__NR_mkdir, 0x20000180ul, 0ul);
  memcpy((void*)0x20000300, "./file0\000", 8);
  syscall(__NR_mkdir, 0x20000300ul, 0ul);
  memcpy((void*)0x200000c0, "./bus\000", 6);
  memcpy((void*)0x20000080, "overlay\000", 8);
  memcpy((void*)0x20000480, "workdir", 7);
  *(uint8_t*)0x20000487 = 0x3d;
  memcpy((void*)0x20000488, "./bus", 5);
  *(uint8_t*)0x2000048d = 0x2c;
  memcpy((void*)0x2000048e, "lowerdir", 8);
  *(uint8_t*)0x20000496 = 0x3d;
  memcpy((void*)0x20000497, "./file0", 7);
  *(uint8_t*)0x2000049e = 0x2c;
  memcpy((void*)0x2000049f, "upperdir", 8);
  *(uint8_t*)0x200004a7 = 0x3d;
  memcpy((void*)0x200004a8, "./file1", 7);
  *(uint8_t*)0x200004af = 0x2c;
  memcpy((void*)0x200004b0, "nfs_export=on", 13);
  *(uint8_t*)0x200004bd = 0x2c;
  *(uint8_t*)0x200004be = 0;
  syscall(__NR_mount, 0ul, 0x200000c0ul, 0x20000080ul, 0ul, 0x20000480ul);
  memcpy((void*)0x20000000, "./bus\000", 6);
  res = syscall(__NR_open, 0x20000000ul, 0ul, 0ul);
  if (res != -1)
    r[0] = res;
  memcpy((void*)0x200001c0, "\x63\x00\x00\x00\xfb\x00\x00\x00\x00\xfb\x19\x09",
         12);
  syscall(__NR_open_by_handle_at, r[0], 0x200001c0ul, 0ul);
  return 0;
}
